@model GamesRental.Web.ViewModels.Game.GameDetailsViewModel

@{
    ViewData["Title"] = "Game Details";
}

<h2>@Model.Title</h2>

<div class="row mt-4">
    <div class="col-md-4">
        <img src="@Model.ImageUrl" alt="@Model.Title" class="img-fluid rounded shadow-sm" />
    </div>
    <div class="col-md-8">
        <p><strong>Genre:</strong> @Model.Genre</p>
        <p><strong>Platform:</strong> @Model.Platform</p>
        <p><strong>Release Date:</strong> @Model.ReleaseDate.ToShortDateString()</p>
        <p><strong>Description:</strong></p>
        <p>@Model.Description</p>

        @if (User.Identity.IsAuthenticated)
        {
            <div class="mt-3">

                @if (Model.HasUserRented && !Model.HasUserRented)
                {
                    <form asp-controller="Rental" asp-action="Rent" method="post" class="d-inline">
                        <input type="hidden" name="gameId" value="@Model.Id" />
                        <button type="submit" class="btn btn-primary">Rent this Game</button>
                    </form>
                }
                else if (Model.HasUserRented)
                {
                    <div class="alert alert-warning">No available copies right now.</div>
                }
                else if (Model.HasUserRented)
                {
                    <div class="alert alert-info">You have already rented this game.</div>
                }

                <form asp-controller="Wishlist" asp-action="@(Model.IsInWishlist ? "Remove" : "Add")" method="post" class="d-inline ms-2">
                    <input type="hidden" name="gameId" value="@Model.Id" />
                    <button type="submit" class="btn btn-outline-danger">
                        @(Model.IsInWishlist ? "Remove from Wishlist" : "Add to Wishlist")
                    </button>
                </form>

                <a asp-controller="Review" asp-action="Create" asp-route-gameId="@Model.Id" class="btn btn-outline-secondary ms-2">
                    Leave a Review
                </a>
            </div>
        }
        else
        {
            <p class="text-muted mt-3">Please <a asp-area="Identity" asp-page="/Account/Login">log in</a> to rent or review.</p>
        }
    </div>
</div>
